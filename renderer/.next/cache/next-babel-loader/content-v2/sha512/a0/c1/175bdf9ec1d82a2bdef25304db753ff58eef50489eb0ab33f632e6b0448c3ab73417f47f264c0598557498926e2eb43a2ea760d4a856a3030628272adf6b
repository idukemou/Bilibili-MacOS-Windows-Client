{"ast":null,"code":"import _regeneratorRuntime from \"/Users/yuxuan/Desktop/Bilibili-MacOS-Windows-Client/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/yuxuan/Desktop/Bilibili-MacOS-Windows-Client/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/Users/yuxuan/Desktop/Bilibili-MacOS-Windows-Client/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport \"antd/lib/popover/style/css\";\nimport _Popover from \"antd/lib/popover\";\nimport \"antd/lib/slider/style/css\";\nimport _Slider from \"antd/lib/slider\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/yuxuan/Desktop/Bilibili-MacOS-Windows-Client/renderer/components/common/videoDetail.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$(),\n    _s4 = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useEffect, useRef, useState } from \"react\";\nimport store from \"../../redux/store\";\nimport { platVideoStatusAction, playVideoInfoAction } from \"../../redux/actionCreators\";\nimport { convertDuration, convertTime, convertViews } from \"../../utils/utils\";\nimport '../../styles/videoPlayer.css';\nimport ContentFrame, { Content } from \"../layout/contentFrame\";\nimport electron from \"electron\";\nvar ipcRenderer = electron.ipcRenderer || false;\n\nfunction MediaPlayer(props) {\n  _s();\n\n  var progressRef = useRef(null);\n  var playerRef = useRef(null);\n\n  var _useState = useState(null),\n      player = _useState[0],\n      setPlayer = _useState[1];\n\n  var _useState2 = useState(null),\n      mediaContainer = _useState2[0],\n      setMediaContainer = _useState2[1];\n\n  var _useState3 = useState(false),\n      ready = _useState3[0],\n      setReady = _useState3[1];\n\n  var _useState4 = useState(false),\n      isPlay = _useState4[0],\n      setIsPlay = _useState4[1];\n\n  var _useState5 = useState(false),\n      isMuted = _useState5[0],\n      setIsMuted = _useState5[1];\n\n  var _useState6 = useState(false),\n      isFullScreen = _useState6[0],\n      setIsFullScreen = _useState6[1];\n\n  var _useState7 = useState(0),\n      processTime = _useState7[0],\n      setProcessTime = _useState7[1];\n\n  var _useState8 = useState(0),\n      duration = _useState8[0],\n      setDuration = _useState8[1];\n\n  var _useState9 = useState(0),\n      bufferedTime = _useState9[0],\n      setBufferedTime = _useState9[1];\n\n  var _useState10 = useState(null),\n      processor = _useState10[0],\n      setProcessor = _useState10[1];\n\n  var _useState11 = useState(100),\n      volume = _useState11[0],\n      setVolume = _useState11[1];\n\n  var _useState12 = useState(1),\n      speedRate = _useState12[0],\n      setSpeedRate = _useState12[1];\n\n  var _useState13 = useState(props.url),\n      url = _useState13[0],\n      setUrl = _useState13[1];\n\n  useEffect(function () {\n    console.log(\"url 好像变了\");\n\n    if (flvjs.isSupported() && url.length > 10) {\n      setPlayer(flvjs.createPlayer({\n        type: 'flv',\n        isLive: false,\n        hasVideo: true,\n        hasAudio: true,\n        url: url\n      }, {\n        lazyLoad: false\n      }));\n      setMediaContainer(document.getElementById('media-player'));\n      setReady(true);\n    }\n  }, [url]);\n  useEffect(function () {\n    if (url !== props.url) {\n      setUrl(url);\n    }\n  }, [props.url]);\n  useEffect(function () {\n    if (player !== null) {\n      initPlayer();\n    }\n  }, [ready]);\n\n  function initPlayer() {\n    if (player !== null && mediaContainer !== null) {\n      player.attachMediaElement(mediaContainer);\n      player.unload();\n      player.load();\n\n      mediaContainer.onloadeddata = function () {\n        play();\n        setDuration(getDuration());\n        setVolume(getPlayerVolume());\n      };\n\n      mediaContainer.onplay = function () {\n        clearInterval(processor);\n        setIsPlay(true);\n        setProcessor(setInterval(function () {\n          setProcessTime(getCurrentTime());\n        }, speedRate * 1000));\n      };\n\n      mediaContainer.onended = function () {\n        clearInterval(processor);\n      };\n\n      mediaContainer.onprogress = function () {\n        if (mediaContainer.buffered.length > 0) {\n          setBufferedTime(mediaContainer.buffered.end(0));\n        }\n      };\n    }\n  }\n\n  function play() {\n    if (player !== null) {\n      player.play().then(function () {})[\"catch\"](function (e) {});\n    }\n  }\n\n  function pause() {\n    clearInterval(processor);\n\n    if (player !== null) {\n      player.pause();\n      setIsPlay(false);\n    }\n  }\n\n  function destroy() {\n    if (player !== null) {\n      clearInterval(processor);\n      pause();\n      player.unload();\n      player.detachMediaElement();\n      player.destroy();\n      setPlayer(null);\n    }\n  }\n\n  function getCurrentTime() {\n    if (player === null) return 0;\n\n    if (convertDuration(player.currentTime) === convertDuration(player.duration)) {\n      return player.duration;\n    } else {\n      return player.currentTime;\n    }\n  }\n\n  function setCurrentTime(time) {\n    if (player !== null) {\n      player.currentTime = time;\n    }\n  }\n\n  function appendSeek(time) {\n    player.currentTime = player.currentTime + time;\n  }\n\n  function pushSeek() {\n    appendSeek(0.125);\n  }\n\n  function getDuration() {\n    if (player !== null) {\n      return player.duration;\n    }\n\n    return 0;\n  }\n\n  function setPlayerVolume(volume) {\n    if (player !== null) {\n      player.volume = volume / 100;\n    }\n  }\n\n  function getPlayerVolume() {\n    if (player !== null) {\n      return player.volume;\n    }\n  }\n\n  function muteSwitcher() {\n    if (isMuted && player !== null) {\n      player.muted = false;\n      setIsMuted(false);\n    } else {\n      player.muted = true;\n      setIsMuted(true);\n    }\n  }\n\n  function playSwitcher() {\n    isPlay ? pause() : play();\n  }\n\n  function replay() {\n    if (player !== null) {\n      pause();\n      setCurrentTime(0);\n      play();\n    }\n  }\n\n  function setPlayerSpeedRate(rate) {\n    if (mediaContainer !== null) {\n      mediaContainer.playbackRate = rate;\n      setSpeedRate(rate);\n    }\n  }\n\n  function handleChangeVolume(value) {\n    setPlayerVolume(value);\n\n    if (value > 0) {\n      setIsMuted(false);\n    } else {\n      setIsMuted(true);\n    }\n  }\n\n  function handleProgressChange(_ref) {\n    var value = _ref.target.value;\n    pause();\n    setProcessTime(value);\n  }\n\n  function mouseDownEvent() {\n    setProcessTime(progressRef.current.value);\n  }\n\n  function mouseUpEvent() {\n    if (processTime >= bufferedTime) {\n      setTimeout(function () {\n        pushSeek();\n      }, 1000);\n    }\n\n    if (mediaContainer.buffered.length > 0) {\n      if (processTime <= mediaContainer.buffered.start(0)) {\n        setTimeout(function () {\n          pushSeek();\n        }, 1000);\n      }\n    }\n\n    setCurrentTime(processTime);\n    play();\n    console.log(\"Finished, \", convertDuration(processTime));\n  }\n\n  function fullscreen() {\n    if (!isFullScreen) {\n      playerRef.current.requestFullscreen();\n      setIsFullScreen(true);\n    } else {\n      document.exitFullscreen();\n    }\n\n    playerRef.current.addEventListener('fullscreenchange', function () {\n      var state = document.fullScreen || document.mozFullScreen || document.webkitIsFullScreen;\n      !state && setIsFullScreen(false);\n    });\n  }\n\n  function close() {\n    destroy();\n    props.quit();\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"media-player-container\",\n      ref: playerRef,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"media-title-wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"media-button media-control-close\",\n          onClick: function onClick() {\n            return close();\n          },\n          children: /*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"iconfont icon-close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 260,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: props.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n        id: \"media-player\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"media-controls\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"progress-bar-wrapper\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertDuration(processTime)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            ref: progressRef,\n            type: \"range\",\n            min: 0,\n            max: duration,\n            value: processTime,\n            onInput: function onInput(e) {\n              return handleProgressChange(e);\n            },\n            onMouseUp: function onMouseUp() {\n              return mouseUpEvent();\n            },\n            onMouseDown: function onMouseDown() {\n              return mouseDownEvent();\n            },\n            className: \"progress-bar\",\n            style: {\n              background: \"linear-gradient(to right, \\n                                                   rgb(250, 107, 147) 0%, rgb(250, 107, 147) \".concat(processTime / duration * 100, \"%, \\n                                                   #777 \").concat(processTime / duration * 100, \"%, #777 \").concat(bufferedTime / duration * 100, \"%, \\n                                                   #444 \").concat(bufferedTime / duration * 100, \"%, #444 100%\\n                                            )\")\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 274,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertDuration(duration)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"media-control-buttons\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"media-button media-control-play\",\n            onClick: function onClick() {\n              return playSwitcher();\n            },\n            children: isPlay ? /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"iconfont icon-zanting\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 42\n            }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"iconfont icon-bofang\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 298,\n              columnNumber: 84\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"media-button media-control-speed\",\n            onClick: function onClick() {\n              return setPlayerSpeedRate(2);\n            },\n            children: \"2X\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"media-button media-control-speed\",\n            onClick: function onClick() {\n              return setPlayerSpeedRate(1);\n            },\n            children: \"\\u539F\\u901F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(_Popover, {\n            content: /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                height: 120\n              },\n              children: /*#__PURE__*/_jsxDEV(_Slider, {\n                vertical: true,\n                defaultValue: 100,\n                onChange: function onChange(e) {\n                  return handleChangeVolume(e);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 307,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 33\n            }, this),\n            placement: \"top\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"media-button media-control-mute\",\n              onClick: function onClick() {\n                return muteSwitcher();\n              },\n              children: isMuted ? /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"iconfont icon-jingyin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 47\n              }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"iconfont icon-yinliang\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 88\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"media-button media-control-replay\",\n            onClick: function onClick() {\n              return replay();\n            },\n            children: /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"iconfont icon-replay\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 319,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"media-button media-control-fullscreen\",\n            onClick: function onClick() {\n              return fullscreen();\n            },\n            children: isFullScreen ? /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"iconfont icon-fullscreen-exit\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 47\n            }, this) : /*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"iconfont icon-fangda\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 325,\n              columnNumber: 96\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 323,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n}\n\n_s(MediaPlayer, \"xPNfWj4Uipp1ydlcyVvHnC7gjtY=\");\n\n_c = MediaPlayer;\n\nfunction MediaInfo(props) {\n  _s2();\n\n  var _this = this;\n\n  var _useState14 = useState(0),\n      active = _useState14[0],\n      setActive = _useState14[1];\n\n  var menuList = [{\n    name: '简介'\n  }, {\n    name: '评论'\n  }];\n\n  function menuListLayout(data, index, extra) {\n    return /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"video-detail-info-header-option \".concat(active === index && 'active'),\n      onClick: function onClick() {\n        return setActive(index);\n      },\n      children: [data, \" \", extra]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 13\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"video-detail-info-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"video-detail-info-header\",\n      children: menuList.map(function (menu, index) {\n        return menuListLayout(menu.name, index, index === 1 && /*#__PURE__*/_jsxDEV(\"span\", {\n          children: props.videoInfo.stat && props.videoInfo.stat.replay\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 81\n        }, _this));\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(ContentFrame, {\n      className: \"video-detail-info-content\",\n      activeIndex: active,\n      children: [/*#__PURE__*/_jsxDEV(Content, {\n        className: \"video-detail-info-content-item\",\n        children: JSON.stringify(props.videoInfo) !== '{}' && /*#__PURE__*/_jsxDEV(BriefIntro, _objectSpread({}, props), void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 69\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Content, {\n        className: \"video-detail-info-content-item\",\n        children: /*#__PURE__*/_jsxDEV(VideoReviews, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 357,\n    columnNumber: 9\n  }, this);\n}\n\n_s2(MediaInfo, \"LYMHw6xE17pbh6ai9qaw76OM0Ms=\");\n\n_c2 = MediaInfo;\n\nfunction BriefIntro(props) {\n  _s3();\n\n  var _this2 = this;\n\n  var _useState15 = useState([]),\n      tags = _useState15[0],\n      setTags = _useState15[1];\n\n  var _useState16 = useState([]),\n      suggestVideos = _useState16[0],\n      setSuggestVideos = _useState16[1];\n\n  useEffect(function () {\n    if (ipcRenderer && tags.length <= 0) {\n      ipcRenderer.invoke(\"get_video_related_tags\", props.videoInfo.bvid).then(function (res) {\n        if (res.code === 0) {\n          setTags(res.data);\n        }\n      });\n    }\n  }, [tags]);\n  useEffect(function () {\n    if (ipcRenderer && suggestVideos.length <= 0) {\n      ipcRenderer.invoke(\"get_video_suggest_videos\", props.videoInfo.bvid).then(function (res) {\n        if (res.code === 0) {\n          setSuggestVideos(res.data);\n        }\n      });\n    }\n  }, [suggestVideos]);\n\n  function playVideo(bvid) {\n    ipcRenderer.send('request_video_play_info', bvid);\n    ipcRenderer.once('fetch_video_play_info', /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event, data) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.t0 = store;\n                _context.next = 3;\n                return playVideoInfoAction(data);\n\n              case 3:\n                _context.t1 = _context.sent;\n\n                _context.t0.dispatch.call(_context.t0, _context.t1);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n    props.setUrl(\"\");\n    store.dispatch(platVideoStatusAction(true));\n    ipcRenderer.removeAllListeners('request_video_play_info');\n  }\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"brief-intro-info\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"brief-intro-upper-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brief-intro-upper-profile\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"brief-intro-upper-avatar\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: props.videoInfo.owner.face,\n              alt: \"\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 428,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 427,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"brief-intro-upper-username\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"brief-intro-username\",\n              children: props.videoInfo.owner.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 432,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"brief-intro-fans\",\n              children: [convertViews(412513), \"\\u7C89\\u4E1D\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 426,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"is-followed\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"iconfont icon-icon-test\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 30\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u5173\\u6CE8\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 440,\n              columnNumber: 30\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 26\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"brief-intro-video-title\",\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: props.videoInfo.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"brief-intro-video-meta-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brief-intro-video-meta-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"iconfont icon-bofang1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertViews(props.videoInfo.stat.view)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 450,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brief-intro-video-meta-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"iconfont icon-danmushu\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 456,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertViews(props.videoInfo.stat.danmaku)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 455,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brief-intro-video-meta-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"iconfont icon-time\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 461,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertTime(props.videoInfo.pubdate)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 462,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brief-intro-video-meta-item\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: props.videoInfo.bvid\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 449,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"brief-intro-action-btns\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"brief-intro-action-btn\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"icon-thumbsup iconfont\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 472,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertViews(props.videoInfo.stat.like)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 471,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"brief-intro-action-btn\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"icon-thumbs-down iconfont\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertViews(props.videoInfo.stat.dislike)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 478,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 476,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"brief-intro-action-btn\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"icon-Bbi iconfont\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 482,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertViews(props.videoInfo.stat.coin)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 483,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"brief-intro-action-btn\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"icon-star iconfont\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertViews(props.videoInfo.stat.favorite)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"brief-intro-action-btn\",\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"icon-share1 iconfont\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 492,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: convertViews(props.videoInfo.stat.share)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 493,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 470,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 423,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"brief-intro-video-tags\",\n      children: tags.length > 0 && tags.map(function (tag, index) {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brief-intro-video-tag\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: tag.tag_name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 502,\n            columnNumber: 29\n          }, _this2)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 25\n        }, _this2);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 498,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"brief-intro-video-related-suggestions\",\n      children: suggestVideos.length > 0 && suggestVideos.map(function (suggest, index) {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"brief-intro-video-related-suggestion\",\n          onClick: function onClick() {\n            return playVideo(suggest.bvid);\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"brief-intro-video-suggestion-cover\",\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: suggest.pic,\n              alt: suggest.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 514,\n              columnNumber: 33\n            }, _this2), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: suggest.duration\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 515,\n              columnNumber: 33\n            }, _this2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 513,\n            columnNumber: 29\n          }, _this2), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"brief-intro-video-suggestion-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"brief-intro-video-suggestion-info-title\",\n              children: suggest.title\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 519,\n              columnNumber: 33\n            }, _this2), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"brief-intro-video-suggestion-meta-info\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"brief-intro-video-suggestion-video-supper\",\n                children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                  className: \"iconfont icon-UPzhu\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 524,\n                  columnNumber: 41\n                }, _this2), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"brief-intro-video-suggestion-upper-username\",\n                  children: suggest.owner.name\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 525,\n                  columnNumber: 41\n                }, _this2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 523,\n                columnNumber: 37\n              }, _this2), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"brief-intro-video-suggestion-video-stats\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"brief-intro-video-suggestion-video-stats-wrapper\",\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"brief-intro-video-suggestion-video-stat\",\n                    children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"iconfont icon-bofang1\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 532,\n                      columnNumber: 49\n                    }, _this2), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: convertViews(suggest.stat.view)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 533,\n                      columnNumber: 49\n                    }, _this2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 531,\n                    columnNumber: 45\n                  }, _this2), /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"brief-intro-video-suggestion-video-stat\",\n                    children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                      className: \"iconfont icon-danmushu\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 537,\n                      columnNumber: 49\n                    }, _this2), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: convertViews(suggest.stat.danmaku)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 538,\n                      columnNumber: 49\n                    }, _this2)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 536,\n                    columnNumber: 45\n                  }, _this2)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 530,\n                  columnNumber: 41\n                }, _this2), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"watch-later-btn\",\n                  children: /*#__PURE__*/_jsxDEV(\"i\", {\n                    className: \"iconfont icon-gengduo\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 543,\n                    columnNumber: 45\n                  }, _this2)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 542,\n                  columnNumber: 41\n                }, _this2)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 529,\n                columnNumber: 37\n              }, _this2)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 521,\n              columnNumber: 33\n            }, _this2)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 29\n          }, _this2)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 511,\n          columnNumber: 25\n        }, _this2);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n}\n\n_s3(BriefIntro, \"dOhzK8rXT3VtuEUrXk3nruVIk9E=\");\n\n_c3 = BriefIntro;\n\nfunction VideoReviews(props) {\n  return /*#__PURE__*/_jsxDEV(\"span\", {\n    children: \"reviews\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 558,\n    columnNumber: 9\n  }, this);\n}\n/**\n *\n * @param props\n * @returns {JSX.Element}\n * @constructor\n */\n\n\n_c4 = VideoReviews;\nexport default function VideoDetail(props) {\n  _s4();\n\n  var _useState17 = useState(store.getState().playVideoStatus),\n      status = _useState17[0],\n      setStatus = _useState17[1];\n\n  var _useState18 = useState(store.getState().videoInfo.info),\n      videoInfo = _useState18[0],\n      setVideoInfo = _useState18[1];\n\n  var _useState19 = useState(store.getState().videoInfo.url),\n      url = _useState19[0],\n      setUrl = _useState19[1];\n\n  useEffect(function () {\n    var unsubscribe = store.subscribe(function () {\n      if (JSON.stringify(store.getState().videoInfo.info) !== '{}') {\n        setVideoInfo(store.getState().videoInfo.info);\n        setTimeout(function () {\n          unsubscribe();\n        }, 2000);\n      }\n    });\n  }, [store.getState().videoInfo.info]);\n  useEffect(function () {\n    console.log(\"url 变了\");\n    var unsubscribe = store.subscribe(function () {\n      if (JSON.stringify(store.getState().videoInfo.url) !== '{}') {\n        setUrl(store.getState().videoInfo.url.durl[0].url);\n        unsubscribe();\n      }\n    });\n  }, [url]);\n  useEffect(function () {\n    var unsubscribe = store.subscribe(function () {\n      setStatus(store.getState().playVideoStatus);\n      setTimeout(function () {\n        unsubscribe();\n      }, 2000);\n    });\n  }, [store.getState().playVideoStatus]);\n\n  function exitVideo() {\n    store.dispatch(platVideoStatusAction(false));\n    store.dispatch(playVideoInfoAction({\n      url: {},\n      info: {}\n    }));\n    setVideoInfo({});\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    id: \"media-play-page\",\n    style: {\n      display: status ? 'block' : 'none'\n    },\n    children: [status && /*#__PURE__*/_jsxDEV(MediaPlayer, {\n      quit: exitVideo,\n      title: videoInfo.title,\n      url: url\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 617,\n      columnNumber: 27\n    }, this), /*#__PURE__*/_jsxDEV(MediaInfo, {\n      videoInfo: videoInfo,\n      quit: exitVideo,\n      setUrl: setUrl\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 619,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 615,\n    columnNumber: 9\n  }, this);\n}\n\n_s4(VideoDetail, \"1DiqQ9LX4HaWjz6X0m7SOJiIFRg=\");\n\n_c5 = VideoDetail;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"MediaPlayer\");\n$RefreshReg$(_c2, \"MediaInfo\");\n$RefreshReg$(_c3, \"BriefIntro\");\n$RefreshReg$(_c4, \"VideoReviews\");\n$RefreshReg$(_c5, \"VideoDetail\");","map":{"version":3,"sources":["/Users/yuxuan/Desktop/Bilibili-MacOS-Windows-Client/renderer/components/common/videoDetail.jsx"],"names":["useEffect","useRef","useState","store","platVideoStatusAction","playVideoInfoAction","convertDuration","convertTime","convertViews","ContentFrame","Content","electron","ipcRenderer","MediaPlayer","props","progressRef","playerRef","player","setPlayer","mediaContainer","setMediaContainer","ready","setReady","isPlay","setIsPlay","isMuted","setIsMuted","isFullScreen","setIsFullScreen","processTime","setProcessTime","duration","setDuration","bufferedTime","setBufferedTime","processor","setProcessor","volume","setVolume","speedRate","setSpeedRate","url","setUrl","console","log","flvjs","isSupported","length","createPlayer","type","isLive","hasVideo","hasAudio","lazyLoad","document","getElementById","initPlayer","attachMediaElement","unload","load","onloadeddata","play","getDuration","getPlayerVolume","onplay","clearInterval","setInterval","getCurrentTime","onended","onprogress","buffered","end","then","e","pause","destroy","detachMediaElement","currentTime","setCurrentTime","time","appendSeek","pushSeek","setPlayerVolume","muteSwitcher","muted","playSwitcher","replay","setPlayerSpeedRate","rate","playbackRate","handleChangeVolume","value","handleProgressChange","target","mouseDownEvent","current","mouseUpEvent","setTimeout","start","fullscreen","requestFullscreen","exitFullscreen","addEventListener","state","fullScreen","mozFullScreen","webkitIsFullScreen","close","quit","title","background","height","MediaInfo","active","setActive","menuList","name","menuListLayout","data","index","extra","map","menu","videoInfo","stat","JSON","stringify","BriefIntro","tags","setTags","suggestVideos","setSuggestVideos","invoke","bvid","res","code","playVideo","send","once","event","dispatch","removeAllListeners","owner","face","view","danmaku","pubdate","like","dislike","coin","favorite","share","tag","tag_name","suggest","pic","VideoReviews","VideoDetail","getState","playVideoStatus","status","setStatus","info","setVideoInfo","unsubscribe","subscribe","durl","exitVideo","display"],"mappings":"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","sourcesContent":["import {useEffect, useRef, useState} from \"react\";\nimport store from \"../../redux/store\";\nimport {platVideoStatusAction, playVideoInfoAction} from \"../../redux/actionCreators\";\nimport {convertDuration, convertTime, convertViews} from \"../../utils/utils\";\nimport '../../styles/videoPlayer.css';\nimport {Popover, Slider} from \"antd\";\nimport ContentFrame, {Content} from \"../layout/contentFrame\";\nimport electron from \"electron\";\n\nconst ipcRenderer = electron.ipcRenderer || false;\n\nfunction MediaPlayer(props){\n    const progressRef = useRef(null);\n    const playerRef = useRef(null);\n\n    const [player, setPlayer] = useState(null);\n    const [mediaContainer, setMediaContainer] = useState(null);\n    const [ready, setReady] = useState(false);\n\n    const [isPlay, setIsPlay] = useState(false);\n    const [isMuted, setIsMuted] = useState(false);\n    const [isFullScreen, setIsFullScreen] = useState(false);\n\n    const [processTime, setProcessTime] = useState(0);\n    const [duration, setDuration] = useState(0);\n    const [bufferedTime, setBufferedTime] = useState(0);\n    const [processor, setProcessor] = useState(null);\n    const [volume, setVolume] = useState(100);\n    const [speedRate, setSpeedRate] = useState(1);\n    const [url, setUrl] = useState(props.url);\n\n\n\n    useEffect(() => {\n        console.log(\"url 好像变了\");\n        if(flvjs.isSupported() && url.length > 10){\n            setPlayer(flvjs.createPlayer({\n                type: 'flv',\n                isLive: false,\n                hasVideo: true,\n                hasAudio: true,\n                url: url\n            }, {\n                lazyLoad: false,\n            }));\n            setMediaContainer(document.getElementById('media-player'));\n            setReady(true);\n        }\n    }, [url]);\n\n    useEffect(() => {\n        if(url !== props.url){\n            setUrl(url);\n        }\n    }, [props.url])\n\n    useEffect(() => {\n        if(player !== null){\n            initPlayer();\n        }\n    }, [ready]);\n\n    function initPlayer(){\n        if(player !== null && mediaContainer !== null){\n            player.attachMediaElement(mediaContainer);\n            player.unload();\n            player.load();\n\n            mediaContainer.onloadeddata = () => {\n                play();\n                setDuration(getDuration());\n                setVolume(getPlayerVolume());\n            }\n\n            mediaContainer.onplay = () => {\n                clearInterval(processor);\n                setIsPlay(true);\n                setProcessor(setInterval(() => {\n                    setProcessTime(getCurrentTime());\n                }, speedRate * 1000))\n            }\n\n            mediaContainer.onended = () => {\n                clearInterval(processor);\n            }\n\n            mediaContainer.onprogress = () => {\n                if(mediaContainer.buffered.length > 0){\n                    setBufferedTime(mediaContainer.buffered.end(0));\n                }\n            }\n        }\n    }\n\n    function play(){\n        if(player !== null){\n            player.play()\n                .then(() => {})\n                .catch((e) => {});\n        }\n    }\n\n    function pause(){\n        clearInterval(processor);\n        if (player !== null){\n            player.pause();\n            setIsPlay(false);\n        }\n    }\n\n    function destroy(){\n        if(player !== null){\n            clearInterval(processor);\n            pause();\n            player.unload();\n            player.detachMediaElement();\n            player.destroy();\n            setPlayer(null);\n        }\n    }\n\n    function getCurrentTime(){\n        if (player === null) return 0;\n\n        if(convertDuration(player.currentTime) === convertDuration(player.duration)){\n            return player.duration;\n        }else{\n            return player.currentTime;\n        }\n    }\n\n    function setCurrentTime(time){\n        if(player !== null){\n            player.currentTime = time;\n        }\n    }\n\n    function appendSeek(time){\n        player.currentTime = player.currentTime + time;\n    }\n\n    function pushSeek(){\n        appendSeek(0.125);\n    }\n\n    function getDuration(){\n        if(player !== null){\n            return player.duration;\n        }\n        return 0;\n    }\n\n    function setPlayerVolume(volume){\n        if(player !== null){\n            player.volume = volume / 100;\n        }\n    }\n\n    function getPlayerVolume(){\n        if(player !== null){\n            return player.volume;\n        }\n    }\n\n    function muteSwitcher(){\n        if(isMuted && player !== null){\n            player.muted = false;\n            setIsMuted(false);\n        }else{\n            player.muted = true;\n            setIsMuted(true);\n        }\n    }\n\n    function playSwitcher(){\n        isPlay ? pause(): play();\n    }\n\n    function replay(){\n        if(player !== null){\n            pause();\n            setCurrentTime(0);\n            play();\n        }\n    }\n\n    function setPlayerSpeedRate(rate){\n        if(mediaContainer !== null){\n            mediaContainer.playbackRate = rate;\n            setSpeedRate(rate);\n        }\n    }\n\n    function handleChangeVolume(value){\n        setPlayerVolume(value);\n\n        if(value > 0){\n            setIsMuted(false);\n        }else{\n            setIsMuted(true);\n        }\n    }\n\n    function handleProgressChange({target: {value}}){\n        pause();\n        setProcessTime(value);\n    }\n\n    function mouseDownEvent(){\n        setProcessTime(progressRef.current.value);\n    }\n\n    function mouseUpEvent(){\n        if(processTime >= bufferedTime){\n            setTimeout(() => {\n                pushSeek();\n            }, 1000);\n        }\n\n        if(mediaContainer.buffered.length > 0){\n            if(processTime <= mediaContainer.buffered.start(0)){\n                setTimeout(() => {\n                    pushSeek();\n                }, 1000);\n            }\n        }\n\n        setCurrentTime(processTime);\n        play();\n\n        console.log(\"Finished, \", convertDuration(processTime));\n    }\n\n    function fullscreen(){\n        if(!isFullScreen){\n            playerRef.current.requestFullscreen();\n            setIsFullScreen(true);\n        }else{\n            document.exitFullscreen();\n        }\n\n        playerRef.current.addEventListener('fullscreenchange', () => {\n            const state = document.fullScreen || document.mozFullScreen || document.webkitIsFullScreen;\n            !state && setIsFullScreen(false);\n\n        })\n    }\n\n    function close(){\n        destroy();\n        props.quit();\n    }\n\n\n    return(\n        <>\n            <div className=\"media-player-container\" ref={playerRef}>\n\n                <div className=\"media-title-wrapper\">\n                    <button className=\"media-button media-control-close\" onClick={() => close()}>\n                        {\n                            <i className=\"iconfont icon-close\" />\n                        }\n                    </button>\n\n                    <span>{props.title}</span>\n                </div>\n\n                <video id='media-player'/>\n\n                <div className=\"media-controls\">\n                    <div className=\"progress-bar-wrapper\">\n                        <span>{convertDuration(processTime)}</span>\n                        <input\n                            ref={progressRef}\n                            type=\"range\"\n                            min={0}\n                            max={duration}\n                            value={processTime}\n                            onInput={(e) => handleProgressChange(e)}\n                            onMouseUp={() => mouseUpEvent()}\n                            onMouseDown={() => mouseDownEvent()}\n                            className=\"progress-bar\"\n                            style={{\n                                background: `linear-gradient(to right, \n                                                   rgb(250, 107, 147) 0%, rgb(250, 107, 147) ${(processTime/duration) * 100}%, \n                                                   #777 ${(processTime/duration) * 100}%, #777 ${(bufferedTime/duration) * 100}%, \n                                                   #444 ${(bufferedTime/duration) * 100}%, #444 100%\n                                            )`\n                            }}\n                        />\n                        <span>{convertDuration(duration)}</span>\n                    </div>\n\n                    <div className=\"media-control-buttons\">\n                        <button className=\"media-button media-control-play\" onClick={() => playSwitcher()}>\n                            {\n                                isPlay ? <i className=\"iconfont icon-zanting\" /> : <i className=\"iconfont icon-bofang\" />\n                            }\n                        </button>\n                        <button className=\"media-button media-control-speed\" onClick={() => setPlayerSpeedRate(2)}>2X</button>\n                        <button className=\"media-button media-control-speed\" onClick={() => setPlayerSpeedRate(1)}>原速</button>\n\n                        <Popover\n                            content={\n                                <div style={{height: 120}}>\n                                    <Slider vertical defaultValue={100} onChange={(e) => handleChangeVolume(e)} />\n                                </div>\n                            }\n                            placement=\"top\"\n                        >\n                            <button className=\"media-button media-control-mute\" onClick={() => muteSwitcher()}>\n                                {\n                                    isMuted ? <i className=\"iconfont icon-jingyin\"/> : <i className=\"iconfont icon-yinliang\" />\n                                }\n                            </button>\n                        </Popover>\n\n                        <button className=\"media-button media-control-replay\" onClick={() => replay()}>\n                            <i className=\"iconfont icon-replay\" />\n                        </button>\n\n                        <button className=\"media-button media-control-fullscreen\" onClick={() => fullscreen()}>\n                            {\n                                isFullScreen? <i className=\"iconfont icon-fullscreen-exit\"/> : <i className=\"iconfont icon-fangda\"/>\n                            }\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </>\n    )\n}\n\n\nfunction MediaInfo(props){\n\n    const [active, setActive] = useState(0);\n    const menuList = [\n        {name: '简介'},\n        {name: '评论'}\n    ]\n\n    function menuListLayout(data, index, extra){\n        return(\n            <button\n                key={index}\n                className={`video-detail-info-header-option ${active === index && 'active'}`}\n                onClick={() => setActive(index)}\n            >\n                {data} {extra}\n            </button>\n        )\n    }\n\n    return(\n        <div className=\"video-detail-info-container\">\n            <div className=\"video-detail-info-header\">\n                {\n                    menuList.map((menu, index) => {\n                        return menuListLayout(menu.name, index, (index === 1 && <span>{props.videoInfo.stat && props.videoInfo.stat.replay}</span>))\n                    })\n                }\n            </div>\n\n            <ContentFrame className=\"video-detail-info-content\" activeIndex={active}>\n                <Content className={\"video-detail-info-content-item\"}>\n                    {\n                        JSON.stringify(props.videoInfo) !== '{}' && <BriefIntro {...props} />\n                    }\n                </Content>\n                <Content className={\"video-detail-info-content-item\"}>\n                    <VideoReviews/>\n                </Content>\n            </ContentFrame>\n        </div>\n    )\n}\n\nfunction BriefIntro(props){\n\n    const [tags, setTags] = useState([]);\n    const [suggestVideos, setSuggestVideos] = useState([])\n\n    useEffect(() => {\n        if(ipcRenderer && tags.length <= 0){\n            ipcRenderer.invoke(\"get_video_related_tags\", props.videoInfo.bvid)\n                .then(res => {\n                    if(res.code === 0){\n                        setTags(res.data);\n                    }\n                })\n        }\n    }, [tags]);\n\n    useEffect(() => {\n        if(ipcRenderer && suggestVideos.length <= 0 ){\n            ipcRenderer.invoke(\"get_video_suggest_videos\", props.videoInfo.bvid)\n                .then(res => {\n                    if(res.code === 0){\n                        setSuggestVideos(res.data);\n                    }\n                })\n        }\n    }, [suggestVideos]);\n\n\n    function playVideo(bvid){\n\n        ipcRenderer.send('request_video_play_info', bvid);\n        ipcRenderer.once('fetch_video_play_info', async (event, data) => {\n            store.dispatch(await playVideoInfoAction(data));\n        })\n\n        props.setUrl(\"\");\n        store.dispatch(platVideoStatusAction(true));\n        ipcRenderer.removeAllListeners('request_video_play_info');\n    }\n\n\n    return (\n        <>\n            <div className=\"brief-intro-info\">\n\n                <div className=\"brief-intro-upper-info\">\n                    <div className=\"brief-intro-upper-profile\">\n                        <div className=\"brief-intro-upper-avatar\">\n                            <img src={props.videoInfo.owner.face} alt=\"\"/>\n                        </div>\n\n                        <div className=\"brief-intro-upper-username\">\n                            <span className=\"brief-intro-username\">{props.videoInfo.owner.name}</span>\n                            <span className=\"brief-intro-fans\">{convertViews(412513)}粉丝</span>\n                        </div>\n                    </div>\n\n                    <div className=\"is-followed\">\n                         <button>\n                             <i className=\"iconfont icon-icon-test\" />\n                             <span>关注</span>\n                         </button>\n                    </div>\n                </div>\n\n                <div className=\"brief-intro-video-title\">\n                    <span>{props.videoInfo.title}</span>\n                </div>\n\n                <div className=\"brief-intro-video-meta-info\">\n                    <div className=\"brief-intro-video-meta-item\">\n                        <i className=\"iconfont icon-bofang1\" />\n                        <span>{convertViews(props.videoInfo.stat.view)}</span>\n                    </div>\n\n                    <div className=\"brief-intro-video-meta-item\">\n                        <i className=\"iconfont icon-danmushu\" />\n                        <span>{convertViews(props.videoInfo.stat.danmaku)}</span>\n                    </div>\n\n                    <div className=\"brief-intro-video-meta-item\">\n                        <i className=\"iconfont icon-time\" />\n                        <span>{convertTime(props.videoInfo.pubdate)}</span>\n                    </div>\n\n                    <div className=\"brief-intro-video-meta-item\">\n                        <span>{props.videoInfo.bvid}</span>\n                    </div>\n                </div>\n\n                <div className=\"brief-intro-action-btns\">\n                    <button className=\"brief-intro-action-btn\">\n                        <i className=\"icon-thumbsup iconfont\" />\n                        <span>{convertViews(props.videoInfo.stat.like)}</span>\n                    </button>\n\n                    <button className=\"brief-intro-action-btn\">\n                        <i className=\"icon-thumbs-down iconfont\" />\n                        <span>{convertViews(props.videoInfo.stat.dislike)}</span>\n                    </button>\n\n                    <button className=\"brief-intro-action-btn\">\n                        <i className=\"icon-Bbi iconfont\" />\n                        <span>{convertViews(props.videoInfo.stat.coin)}</span>\n                    </button>\n\n                    <button className=\"brief-intro-action-btn\">\n                        <i className=\"icon-star iconfont\" />\n                        <span>{convertViews(props.videoInfo.stat.favorite)}</span>\n                    </button>\n\n                    <button className=\"brief-intro-action-btn\">\n                        <i className=\"icon-share1 iconfont\" />\n                        <span>{convertViews(props.videoInfo.stat.share)}</span>\n                    </button>\n                </div>\n            </div>\n\n            <div className=\"brief-intro-video-tags\">\n                {\n                    tags.length > 0 &&  tags.map((tag, index) => (\n                        <div className=\"brief-intro-video-tag\" key={index}>\n                            <span>{tag.tag_name}</span>\n                        </div>\n                    ))\n                }\n            </div>\n\n            <div className=\"brief-intro-video-related-suggestions\">\n                {\n                    suggestVideos.length > 0 &&  suggestVideos.map((suggest, index) => (\n                        <div className=\"brief-intro-video-related-suggestion\" key={index} onClick={() => playVideo(suggest.bvid)}>\n\n                            <div className=\"brief-intro-video-suggestion-cover\">\n                                <img src={suggest.pic} alt={suggest.title} />\n                                <span>{suggest.duration}</span>\n                            </div>\n\n                            <div className=\"brief-intro-video-suggestion-info\">\n                                <span className=\"brief-intro-video-suggestion-info-title\">{suggest.title}</span>\n\n                                <div className=\"brief-intro-video-suggestion-meta-info\">\n\n                                    <div className=\"brief-intro-video-suggestion-video-supper\">\n                                        <i className=\"iconfont icon-UPzhu\" />\n                                        <span className=\"brief-intro-video-suggestion-upper-username\">{suggest.owner.name}</span>\n                                    </div>\n\n\n                                    <div className=\"brief-intro-video-suggestion-video-stats\">\n                                        <div className=\"brief-intro-video-suggestion-video-stats-wrapper\">\n                                            <div className=\"brief-intro-video-suggestion-video-stat\">\n                                                <i className=\"iconfont icon-bofang1\" />\n                                                <span>{convertViews(suggest.stat.view)}</span>\n                                            </div>\n\n                                            <div className=\"brief-intro-video-suggestion-video-stat\">\n                                                <i className=\"iconfont icon-danmushu\" />\n                                                <span>{convertViews(suggest.stat.danmaku)}</span>\n                                            </div>\n                                        </div>\n\n                                        <button className=\"watch-later-btn\">\n                                            <i className=\"iconfont icon-gengduo\" />\n                                        </button>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    ))\n                }\n            </div>\n        </>\n    )\n}\n\nfunction VideoReviews(props){\n    return(\n        <span>reviews</span>\n    )\n}\n\n/**\n *\n * @param props\n * @returns {JSX.Element}\n * @constructor\n */\nexport default function VideoDetail(props){\n\n    const [status, setStatus] = useState(store.getState().playVideoStatus);\n    const [videoInfo, setVideoInfo] = useState(store.getState().videoInfo.info);\n    const [url, setUrl] = useState(store.getState().videoInfo.url);\n\n    useEffect(() => {\n        const unsubscribe = store.subscribe(() => {\n            if(JSON.stringify(store.getState().videoInfo.info) !== '{}'){\n                setVideoInfo(store.getState().videoInfo.info);\n                setTimeout(() => {\n                    unsubscribe();\n                }, 2000);\n            }\n        })\n    }, [store.getState().videoInfo.info]);\n\n    useEffect(() => {\n        console.log(\"url 变了\");\n        let unsubscribe = store.subscribe(() => {\n            if(JSON.stringify(store.getState().videoInfo.url) !== '{}'){\n                setUrl(store.getState().videoInfo.url.durl[0].url);\n                unsubscribe();\n            }\n        })\n    }, [url]);\n\n    useEffect(() => {\n        const unsubscribe = store.subscribe(() => {\n            setStatus(store.getState().playVideoStatus);\n            setTimeout(() => {\n                unsubscribe();\n            }, 2000);\n        })\n    }, [store.getState().playVideoStatus]);\n\n\n    function exitVideo(){\n        store.dispatch(platVideoStatusAction(false));\n        store.dispatch(playVideoInfoAction({\n            url: {},\n            info: {}\n        }));\n        setVideoInfo({});\n    }\n\n    return(\n        <section id=\"media-play-page\" style={{display: (status ? 'block': 'none')}}>\n            {\n                status && <MediaPlayer quit={exitVideo} title={videoInfo.title} url={url} />\n            }\n            <MediaInfo videoInfo={videoInfo} quit={exitVideo} setUrl={setUrl}/>\n        </section>\n    )\n}"]},"metadata":{},"sourceType":"module"}