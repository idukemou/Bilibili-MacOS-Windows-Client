{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _JSXStyle from \"styled-jsx/style\";\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport '../../styles/layout.css';\nimport App from \"../homePage/app\";\nimport Category from \"../categoryPage/category\";\nimport News from \"../newsPage/news\";\nimport User from \"../userPage/user\";\nimport store from '../../redux/store';\nimport { countAvailableClientHeightAction } from \"../../redux/actionCreators\";\nconst menuList = [{\n  name: '首页',\n  href: '/app',\n  icon: 'icon-shouye'\n}, {\n  name: '分区',\n  href: '/category',\n  icon: 'icon-category'\n}, {\n  name: '动态',\n  href: '/news',\n  icon: 'icon-dongtai'\n}, {\n  name: '我的',\n  href: '/user',\n  icon: 'icon-bilibili-line'\n}];\nexport default class Layout extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"init\", () => {\n      this.setState({\n        autoHeight: window.innerHeight - 60\n      }, () => {\n        store.dispatch(countAvailableClientHeightAction({\n          width: window.innerWidth,\n          height: window.innerHeight - 120\n        }));\n      });\n    });\n\n    _defineProperty(this, \"handleChangePage\", page => {\n      this.setState({\n        page\n      });\n    });\n\n    this.state = {\n      page: '/app',\n      autoHeight: 0,\n      scroll: {\n        app: 0,\n        category: 0,\n        news: 0,\n        user: 0\n      }\n    };\n  }\n\n  shouldComponentUpdate(nextProps, nextState, nextContext) {\n    switch (nextState.page) {\n      case '/app':\n        this.section.scrollTo(0, nextState.scroll.app);\n        break;\n\n      case '/category':\n        this.section.scrollTo(0, nextState.scroll.category);\n        break;\n\n      case '/news':\n        this.section.scrollTo(0, nextState.scroll.news);\n        break;\n\n      case '/user':\n        this.section.scrollTo(0, nextState.scroll.user);\n    }\n\n    return true;\n  }\n\n  componentDidMount() {\n    const _this = this;\n\n    this.init();\n    /* 自动设置全局导航和全局内容区块的高度和位置 */\n\n    window.addEventListener('resize', e => {\n      _this.init();\n    });\n    /* 设置页面的实时高度 */\n\n    this.section.addEventListener('scroll', () => {\n      let top = _this.section.scrollTop;\n      const newState = JSON.parse(JSON.stringify(this.state));\n\n      switch (_this.state.page) {\n        case '/app':\n          newState.scroll.app = top;\n          break;\n\n        case '/category':\n          newState.scroll.category = top;\n          break;\n\n        case '/news':\n          newState.scroll.news = top;\n          break;\n\n        case '/user':\n          newState.scroll.user = top;\n      }\n\n      this.setState(newState);\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsx(_Fragment, {\n      children: /*#__PURE__*/_jsxs(\"section\", {\n        id: \"layout-container\",\n        children: [/*#__PURE__*/_jsxs(\"section\", {\n          id: \"layout-content-container\",\n          ref: section => this.section = section,\n          className: _JSXStyle.dynamic([[\"4184239453\", [this.state.autoHeight]]]),\n          children: [/*#__PURE__*/_jsx(App, {\n            display: this.state.page === '/app' ? true : false\n          }), /*#__PURE__*/_jsx(Category, {\n            display: this.state.page === '/category' ? true : false\n          }), /*#__PURE__*/_jsx(News, {\n            display: this.state.page === '/news' ? true : false\n          }), /*#__PURE__*/_jsx(User, {\n            display: this.state.page === '/user' ? true : false\n          }), /*#__PURE__*/_jsx(_JSXStyle, {\n            id: \"4184239453\",\n            dynamic: [this.state.autoHeight],\n            children: [`#layout-content-container.__jsx-style-dynamic-selector{width:100%;height:${this.state.autoHeight}px;}`]\n          })]\n        }), /*#__PURE__*/_jsx(\"footer\", {\n          id: \"layout-navigation-container\",\n          children: menuList.map((menu, index) => /*#__PURE__*/_jsxs(\"a\", {\n            className: `\n                                        layout-navigation-item \n                                        ${menu.href.includes(this.state.page) ? 'active' : ''}\n                                    `,\n            onClick: () => this.handleChangePage(menu.href),\n            children: [/*#__PURE__*/_jsx(\"i\", {\n              className: `iconfont ${menu.icon} layout-navigation-icon`\n            }), /*#__PURE__*/_jsx(\"span\", {\n              children: menu.name\n            })]\n          }, menu.href))\n        })]\n      })\n    });\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}