{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/yuxuan/Desktop/Bilibili-MacOS-Windows-Client/renderer/components/common/videoDetail.jsx\";\nimport { useEffect, useRef, useState } from \"react\";\nimport store from \"../../redux/store\";\nimport { platVideoStatusAction, playVideoInfoAction } from \"../../redux/actionCreators\";\n/**\n *\n * @param props\n * @returns {JSX.Element}\n * @constructor\n */\n\nfunction Video(props) {\n  consolelog(\"新开的\");\n  let flvPlayer = null;\n  const {\n    0: url,\n    1: setUrl\n  } = useState(store.getState().videoInfo.url);\n  useEffect(() => {\n    store.subscribe(() => {\n      if (JSON.stringify(store.getState().videoInfo.url) !== '{}') {\n        const temp = store.getState().videoInfo.url.durl[0].url;\n        setUrl(temp);\n      }\n    });\n  }, [store.getState().videoInfo.url]);\n  useEffect(() => {\n    if (flvjs.isSupported()) {\n      player_load(url);\n    }\n  });\n  useEffect(() => {\n    if (!status) {\n      player_destroy();\n    }\n  }, [props.status]);\n\n  function player_load(url) {\n    if (flvPlayer !== null || flvPlayer !== undefined) {\n      player_destroy();\n    }\n\n    flvPlayer = flvjs.createPlayer({\n      type: 'flv',\n      hasVideo: true,\n      hasAudio: true,\n      url: url\n    });\n    flvPlayer.attachMediaElement(document.getElementById('playerContainer'));\n    flvPlayer.load();\n  }\n\n  function player_start() {\n    if (flvPlayer !== null) {\n      flvPlayer.play();\n    }\n  }\n\n  function player_pause() {\n    if (flvPlayer !== null) {\n      flvPlayer.pause();\n    }\n  }\n\n  function player_destroy() {\n    if (flvPlayer !== null) {\n      flvPlayer.pause();\n      flvPlayer.unload();\n      flvPlayer.detachMediaElement();\n      flvPlayer.destroy();\n      flvPlayer = null;\n    }\n  }\n\n  function player_specificTime() {\n    if (flvPlayer !== null) {\n      flvPlayer.currentTime = flvPlayer.currentTime + 10;\n    }\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: 640,\n      height: 480,\n      border: '1px solid #000'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      id: \"playerContainer\",\n      width: \"640px\",\n      height: \"480px\",\n      controls: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => player_start(),\n      children: \"play\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => player_pause(),\n      children: \"pause\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => player_destroy(),\n      children: \"destroy\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => player_specificTime(),\n      children: \"10\\u79D2\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 9\n  }, this);\n}\n/**\n *\n * @param props\n * @returns {JSX.Element}\n * @constructor\n */\n\n\nexport default function VideoDetail(props) {\n  const {\n    0: status,\n    1: setStatus\n  } = useState(store.getState().playVideoStatus);\n  useEffect(() => {\n    store.subscribe(() => {\n      setStatus(store.getState().playVideoStatus);\n    });\n  }, [store.getState().playVideoStatus]);\n\n  function exitVideo() {\n    store.dispatch(platVideoStatusAction(false));\n    store.dispatch(playVideoInfoAction({\n      url: {},\n      info: {}\n    }));\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    style: {\n      position: 'absolute',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      zIndex: '10000',\n      backgroundColor: 'lightpink',\n      display: status ? 'block' : 'none'\n    },\n    children: [status && /*#__PURE__*/_jsxDEV(Video, {\n      status: status\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 27\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 18\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 23\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 28\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => exitVideo(),\n      children: \"cancel\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 122,\n    columnNumber: 9\n  }, this);\n}","map":{"version":3,"sources":["/Users/yuxuan/Desktop/Bilibili-MacOS-Windows-Client/renderer/components/common/videoDetail.jsx"],"names":["useEffect","useRef","useState","store","platVideoStatusAction","playVideoInfoAction","Video","props","consolelog","flvPlayer","url","setUrl","getState","videoInfo","subscribe","JSON","stringify","temp","durl","flvjs","isSupported","player_load","status","player_destroy","undefined","createPlayer","type","hasVideo","hasAudio","attachMediaElement","document","getElementById","load","player_start","play","player_pause","pause","unload","detachMediaElement","destroy","player_specificTime","currentTime","width","height","border","VideoDetail","setStatus","playVideoStatus","exitVideo","dispatch","info","position","top","left","right","bottom","zIndex","backgroundColor","display"],"mappings":"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","sourcesContent":["import {useEffect, useRef, useState} from \"react\";\nimport store from \"../../redux/store\";\nimport {platVideoStatusAction, playVideoInfoAction} from \"../../redux/actionCreators\";\n\n/**\n *\n * @param props\n * @returns {JSX.Element}\n * @constructor\n */\nfunction Video(props){\n\n    consolelog(\"新开的\");\n\n    let flvPlayer = null;\n    const [url, setUrl] = useState(store.getState().videoInfo.url);\n\n    useEffect(() => {\n        store.subscribe(() => {\n            if(JSON.stringify(store.getState().videoInfo.url) !== '{}'){\n                const temp = store.getState().videoInfo.url.durl[0].url;\n                setUrl(temp);\n            }\n        })\n    }, [store.getState().videoInfo.url]);\n\n    useEffect(() => {\n        if(flvjs.isSupported()){\n            player_load(url);\n        }\n    })\n\n    useEffect(() => {\n        if(!status){\n            player_destroy();\n        }\n    }, [props.status])\n\n\n    function player_load(url){\n        if(flvPlayer !== null || flvPlayer !== undefined){\n            player_destroy();\n        }\n\n        flvPlayer = flvjs.createPlayer({\n            type: 'flv',\n            hasVideo: true,\n            hasAudio: true,\n            url: url\n        });\n\n        flvPlayer.attachMediaElement(document.getElementById('playerContainer'));\n        flvPlayer.load();\n    }\n\n    function player_start(){\n        if(flvPlayer !== null){\n            flvPlayer.play();\n        }\n    }\n\n    function player_pause(){\n        if(flvPlayer !== null){\n            flvPlayer.pause();\n        }\n    }\n\n    function player_destroy(){\n        if(flvPlayer !== null){\n            flvPlayer.pause();\n            flvPlayer.unload();\n            flvPlayer.detachMediaElement();\n            flvPlayer.destroy();\n            flvPlayer = null;\n        }\n    }\n\n    function player_specificTime(){\n        if(flvPlayer !== null){\n            flvPlayer.currentTime = flvPlayer.currentTime + 10;\n        }\n    }\n\n    return(\n        <div style={{width:640, height:480, border: '1px solid #000'}}>\n            <video id='playerContainer' width='640px' height='480px' controls={true}></video>\n            <button onClick={() => player_start()}>play</button>\n            <button onClick={() => player_pause()}>pause</button>\n            <button onClick={() => player_destroy()}>destroy</button>\n            <button onClick={() => player_specificTime()}>10秒</button>\n        </div>\n    )\n}\n\n\n/**\n *\n * @param props\n * @returns {JSX.Element}\n * @constructor\n */\nexport default function VideoDetail(props){\n\n    const [status, setStatus] = useState(store.getState().playVideoStatus);\n\n    useEffect(() => {\n        store.subscribe(() => {\n            setStatus(store.getState().playVideoStatus);\n        })\n    }, [store.getState().playVideoStatus]);\n\n\n    function exitVideo(){\n        store.dispatch(platVideoStatusAction(false));\n        store.dispatch(playVideoInfoAction({\n            url: {},\n            info: {}\n        }));\n    }\n\n    return(\n        <section style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            zIndex: '10000',\n            backgroundColor: 'lightpink',\n            display: (status ? 'block': 'none')\n        }}>\n            {\n                status && <Video status={status} />\n            }\n            <br/><br/><br/><br/>\n            <button onClick={() => exitVideo()}>cancel</button>\n        </section>\n    )\n}"]},"metadata":{},"sourceType":"module"}